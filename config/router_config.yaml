# Intelligent Query Router Configuration
# Version: 1.0.0

version: "1.0.0"
environment: "production"

# Core Settings
default_routing_strategy: "balanced"  # performance, cost, specialization, balanced, round_robin
enable_intelligent_routing: true
enable_fallback: true
max_alternatives: 3
routing_timeout: 100.0  # milliseconds
cache_ttl: 300  # seconds

# Load Balancing
default_load_balancing_strategy: "health_based"  # round_robin, weighted, least_connections, least_response_time, health_based
enable_round_robin_fallback: true

# Routing Policies
policies:
  - policy_id: "chinese_optimal"
    name: "Chinese Content Optimal Routing"
    description: "Route Chinese content to ZAI for best performance"
    priority: 9
    is_active: true
    query_types: ["chinese_content"]
    languages: ["chinese"]
    preferred_providers: ["zai"]
    routing_strategy: "specialization"
    max_cost_per_request: 0.02
    tags: ["language", "cost_optimized"]

  - policy_id: "code_generation_priority"
    name: "Code Generation Priority Routing"
    description: "Route code generation to most capable models"
    priority: 8
    is_active: true
    query_types: ["code_generation"]
    preferred_providers: ["openai", "anthropic"]
    excluded_models: ["gpt-3.5-turbo"]
    routing_strategy: "specialization"
    min_confidence_score: 0.8
    tags: ["code", "quality"]

  - policy_id: "cost_sensitive_simple"
    name: "Cost Sensitive Simple Queries"
    description: "Route simple queries to cost-effective models"
    priority: 6
    is_active: true
    query_types: ["simple_qa", "translation", "summarization"]
    complexity_levels: [1, 2]  # Very Low, Low
    routing_strategy: "cost"
    max_cost_per_request: 0.005
    tags: ["cost", "simple_queries"]

  - policy_id: "research_priority"
    name: "Research and Analysis Priority"
    description: "Route research queries to specialized models"
    priority: 7
    is_active: true
    query_types: ["research", "data_analysis"]
    preferred_providers: ["openai", "anthropic", "perplexity"]
    routing_strategy: "specialization"
    max_response_time: 5000
    tags: ["research", "analysis"]

  - policy_id: "automation_tasks"
    name: "Android Automation Tasks"
    description: "Route automation queries to suitable models"
    priority: 8
    is_active: true
    query_types: ["automation"]
    preferred_providers: ["openai", "anthropic"]
    routing_strategy: "specialization"
    tags: ["automation", "ish_chat"]

  - policy_id: "business_hours_high_quality"
    name: "Business Hours High Quality"
    description: "Prioritize quality during business hours"
    priority: 5
    is_active: true
    time_windows:
      - start: "09:00"
        end: "17:00"
    routing_strategy: "specialization"
    min_confidence_score: 0.8
    max_cost_per_request: 0.05
    tags: ["business_hours", "quality"]

  - policy_id: "after_hours_cost_optimized"
    name: "After Hours Cost Optimized"
    description: "Optimize for cost during off hours"
    priority: 4
    is_active: true
    time_windows:
      - start: "17:01"
        end: "08:59"
    routing_strategy: "cost"
    max_cost_per_request: 0.01
    tags: ["cost_optimized", "off_hours"]

# Model Specializations
model_specializations:
  zai_glm4:
    provider_type: "zai"
    model_name: "glm-4"
    strengths: ["chinese_content", "general", "simple_qa"]
    weaknesses: ["code_generation", "multimodal"]
    cost_per_1k_tokens: 0.01
    average_response_time: 800
    quality_score: 0.85
    max_tokens: 8000
    supports_streaming: true
    supports_functions: false

  openai_gpt4:
    provider_type: "openai"
    model_name: "gpt-4"
    strengths: ["complex_reasoning", "code_generation", "data_analysis", "research"]
    weaknesses: ["chinese_content"]
    cost_per_1k_tokens: 0.03
    average_response_time: 1200
    quality_score: 0.95
    max_tokens: 8000
    supports_streaming: true
    supports_functions: true

  openai_gpt35:
    provider_type: "openai"
    model_name: "gpt-3.5-turbo"
    strengths: ["simple_qa", "translation", "summarization"]
    weaknesses: ["complex_reasoning", "code_generation"]
    cost_per_1k_tokens: 0.002
    average_response_time: 600
    quality_score: 0.80
    max_tokens: 4000
    supports_streaming: true
    supports_functions: true

  anthropic_claude:
    provider_type: "anthropic"
    model_name: "claude-3-sonnet-20240229"
    strengths: ["complex_reasoning", "creative_writing", "data_analysis", "research"]
    weaknesses: ["chinese_content"]
    cost_per_1k_tokens: 0.015
    average_response_time: 1000
    quality_score: 0.92
    max_tokens: 4000
    supports_streaming: false
    supports_functions: true

  perplexity:
    provider_type: "perplexity"
    model_name: "perplexity-online"
    strengths: ["research", "data_analysis"]
    weaknesses: ["code_generation", "automation"]
    cost_per_1k_tokens: 0.02
    average_response_time: 2000
    quality_score: 0.88
    max_tokens: 4000
    supports_streaming: false
    supports_functions: false

# Cost Configuration
cost_config:
  enable_cost_tracking: true
  cost_budget_monthly: 1000.0  # USD
  cost_alert_threshold: 0.8  # Alert at 80% of budget
  cost_per_request_limits:
    zai: 0.02
    openai: 0.05
    anthropic: 0.03
    perplexity: 0.04
  
  # Cost optimization settings
  enable_cost_optimization: true
  cost_weight_in_routing: 0.2  # Weight for cost in balanced routing
  cheap_model_threshold: 0.01  # Below this is considered cheap
  
  # Model-specific costs (per 1k tokens) - these override defaults
  model_costs:
    "gpt-3.5-turbo": 0.002
    "gpt-4": 0.03
    "glm-4": 0.01
    "claude-3-sonnet-20240229": 0.015
    "perplexity-online": 0.02
  
  # Currency and billing
  currency: "USD"
  billing_cycle_start_day: 1

# Performance Thresholds
performance_thresholds:
  # Response time thresholds (ms)
  max_routing_time: 100.0
  max_response_time: 5000.0
  p95_response_time_threshold: 3000.0
  
  # Success rate thresholds (%)
  min_success_rate: 95.0
  min_confidence_score: 0.7
  
  # Error rate thresholds (%)
  max_error_rate: 5.0
  max_timeout_rate: 2.0
  
  # Capacity thresholds (%)
  max_utilization_threshold: 80.0
  scale_up_threshold: 70.0
  scale_down_threshold: 20.0
  
  # Circuit breaker thresholds
  circuit_breaker_failure_threshold: 5
  circuit_breaker_timeout: 60
  circuit_breaker_success_threshold: 3

# Query Classification
enable_query_classification: true
classification_confidence_threshold: 0.7

# Monitoring and Analytics
enable_monitoring: true
enable_analytics: true
metrics_retention_days: 30

# Feature Flags
enable_ml_routing: false  # Future ML-based routing
enable_ab_testing: false  # A/B testing for routing strategies
enable_real_time_optimization: true

# Security
enable_request_logging: true
mask_sensitive_data: true
max_request_size: 10000  # characters

# Timestamps
created_at: "2025-11-03T00:00:00Z"
updated_at: "2025-11-03T00:00:00Z"